<!DOCTYPE HTML>  
<html>  
<head>  
    <meta http-equiv="content-type" content="text/html" />
    <meta name="a" content="https://www.1.com" />  
    <title>数衍测试</title> 
	<link rel="stylesheet" href="static/css/index.css" />
     <script>
				var socket;
		var datastr='';
		var isconnect=false;
	
		var datastr101='{\"ntype\":\"101\",\"params\":{\"orderId\":\"9651a846f29a4907a1dd665426714141\",\"vaccinateUnit\":\"古饶镇赵集卫生院\",\"deviceId\":\"340604080211\",\"vaccinateRegDoctor\":\"测试\",\"vaccinateDate\":\"2020-01-02 22:52:49\",\"vaccinateRealName\":\"张三\",\"immuneCardNo\":\"340621030120190074\",\"immuneCardNo2\":\"\",\"vaccinateBirthday\":\"2000-01-01\",\"vaccinateAge\":\"20岁0月\",\"vaccinateGender\":\"男\",\"vaccinateFatherName\":\"\",\"vaccinateMotherName\":\"\",\"userProvince\":\"3406040802\",\"vaccineInfoList\":[{\"traceCode\":\"81328480433462095927\",\"vaccineName\":\"重组乙型肝炎疫苗(酿酒酵母)\",\"vaccineSpecification\":\"每支0.5ml.每1次人用剂量0.5ml,含HBsAg 10μg\",\"vaccineDosage\":\"注射剂\",\"vaccineCreateDate\":\"2018-04-09\",\"vaccineValidDate\":\"2021-04-08\",\"vaccineBatchNum\":\"C201804070\",\"vaccineProduceEnterprise\":\"深圳康泰生物制品股份有限公司\",\"vaccinateDosageTime\":1,\"vaccinatePart\":\"左上臂三角肌\",\"vaccinateType\":\"常规接种\",\"checkstatus\":\"0\",\"checkerrormsg\":\"接种姓名：张三,疫苗核验成功，请签字确认\"}]},\"timestamp\":\"202012225249558\"}';
		var datastr101Err='{\"ntype\":\"101\",\"params\":{\"orderId\":\"2019010201-01\",\"vaccinateUnit\":\"仁和县社区接种中心)\",\"deviceId\":\"100058001\",\"vaccinateRegDoctor\":\"韩梅梅\",\"vaccinateInjectDoctor\":\"王梅\",\"vaccinateDate\":\"2019-12-12 10:10:10\",\"vaccinateRealName\":\"王强\",\"immuneCardNo\":\"6941235678\",\"immuneCardNo2\":\"37012454654645644\",\"vaccinateBirthday\":\"2018-11-12\",\"vaccinateAge\":\"1年零1个月\",\"vaccinateGender\":\"男\",\"vaccinateFatherName\":\"父亲姓名\",\"vaccinateMotherName\":\"母亲姓名\",\"userProvince\":\"安徽省\",\"vaccineInfoList\":[{\"traceCode\":\"86123456789012131132\",\"vaccineName\":\"疫苗名称1\",\"vaccineSpecification\":\"疫苗规格1\",\"vaccineDosage\":\"疫苗剂型1)\",\"vaccineCreateDate\":\"2017-01-12\",\"vaccineValidDate\":\"2019-01-12\",\"vaccineBatchNum\":\"190112\",\"vaccineProduceEnterprise\":\"深圳疫苗企业有限公司\",\"vaccinateDosageTime\":\"1\",\"vaccinatePart\":\"左上臂\",\"vaccinateType\":\"常规\",\"checkstatus\":\"1\",\"checkerrormsg\":\"疫苗已过有效期,请与接种医生确认\"}]},\"timestamp\":\"20190909103213214\"}';
		var datastr101Mutil='{\"ntype\":\"101\",\"params\":{\"orderId\":\"2019010201-01\",\"vaccinateUnit\":\"仁和县社区接种中心)\",\"deviceId\":\"100058001\",\"vaccinateRegDoctor\":\"韩梅梅\",\"vaccinateInjectDoctor\":\"王梅\",\"vaccinateDate\":\"2019-12-12 10:10:10\",\"vaccinateRealName\":\"王强\",\"immuneCardNo\":\"6941235678\",\"immuneCardNo2\":\"37012454654645644\",\"vaccinateBirthday\":\"2018-11-12\",\"vaccinateAge\":\"1年零1个月\",\"vaccinateGender\":\"男\",\"vaccinateFatherName\":\"父亲姓名\",\"vaccinateMotherName\":\"母亲姓名\",\"userProvince\":\"安徽省\",\"vaccineInfoList\":[{\"traceCode\":\"86123456789012131132\",\"vaccineName\":\"疫苗名称1\",\"vaccineSpecification\":\"疫苗规格1\",\"vaccineDosage\":\"疫苗剂型1)\",\"vaccineCreateDate\":\"2019-01-12\",\"vaccineValidDate\":\"2021-01-12\",\"vaccineBatchNum\":\"190112\",\"vaccineProduceEnterprise\":\"深圳疫苗企业有限公司\",\"vaccinateDosageTime\":\"1\",\"vaccinatePart\":\"左上臂\",\"vaccinateType\":\"常规\",\"checkstatus\":\"0\",\"checkerrormsg\":\"疫苗核验成功，请签字确认\"},{\"traceCode\":\"86123456789012131133\",\"vaccineName\":\"疫苗名称2\",\"vaccineSpecification\":\"疫苗规格2\",\"vaccineDosage\":\"疫苗剂型2\",\"vaccineCreateDate\":\"2019-01-13\",\"vaccineValidDate\":\"2021-01-13\",\"vaccineBatchNum\":\"190113\",\"vaccineProduceEnterprise\":\"深圳疫苗企业有限公司\",\"vaccinateDosageTime\":\"2\",\"vaccinatePart\":\"右上臂\",\"vaccinateType\":\"常规\",\"checkstatus\":\"0\",\"checkerrormsg\":\"\"}]},\"timestamp\":\"20190909103213214\"}';
		var datastr101Mutil5='{\"ntype\":\"101\",\"params\":{\"orderId\":\"2019010201-01\",\"vaccinateUnit\":\"仁和县社区接种中心)\",\"deviceId\":\"100058001\",\"vaccinateRegDoctor\":\"韩梅梅\",\"vaccinateInjectDoctor\":\"王梅\",\"vaccinateDate\":\"2019-12-12 10:10:10\",\"vaccinateRealName\":\"王强\",\"immuneCardNo\":\"6941235678\",\"immuneCardNo2\":\"37012454654645644\",\"vaccinateBirthday\":\"2018-11-12\",\"vaccinateAge\":\"1年零1个月\",\"vaccinateGender\":\"男\",\"vaccinateFatherName\":\"父亲姓名\",\"vaccinateMotherName\":\"母亲姓名\",\"userProvince\":\"安徽省\",\"vaccineInfoList\":[{\"traceCode\":\"86123456789012131132\",\"vaccineName\":\"疫苗名称1\",\"vaccineSpecification\":\"疫苗规格1\",\"vaccineDosage\":\"疫苗剂型1)\",\"vaccineCreateDate\":\"2019-01-12\",\"vaccineValidDate\":\"2021-01-12\",\"vaccineBatchNum\":\"190112\",\"vaccineProduceEnterprise\":\"深圳疫苗企业有限公司\",\"vaccinateDosageTime\":\"1\",\"vaccinatePart\":\"左上臂\",\"vaccinateType\":\"常规\",\"checkstatus\":\"0\",\"checkerrormsg\":\"疫苗核验成功，请签字确认\"},{\"traceCode\":\"86123456789012131133\",\"vaccineName\":\"疫苗名称2\",\"vaccineSpecification\":\"疫苗规格2\",\"vaccineDosage\":\"疫苗剂型2)\",\"vaccineCreateDate\":\"2019-01-12\",\"vaccineValidDate\":\"2021-01-12\",\"vaccineBatchNum\":\"190112\",\"vaccineProduceEnterprise\":\"深圳疫苗企业有限公司\",\"vaccinateDosageTime\":\"1\",\"vaccinatePart\":\"左上臂\",\"vaccinateType\":\"常规\",\"checkstatus\":\"0\",\"checkerrormsg\":\"疫苗核验成功，请签字确认\"},{\"traceCode\":\"86123456789012131134\",\"vaccineName\":\"疫苗名称3\",\"vaccineSpecification\":\"疫苗规格3\",\"vaccineDosage\":\"疫苗剂型3)\",\"vaccineCreateDate\":\"2019-01-12\",\"vaccineValidDate\":\"2021-01-12\",\"vaccineBatchNum\":\"190112\",\"vaccineProduceEnterprise\":\"深圳疫苗企业有限公司\",\"vaccinateDosageTime\":\"1\",\"vaccinatePart\":\"左上臂\",\"vaccinateType\":\"常规\",\"checkstatus\":\"0\",\"checkerrormsg\":\"疫苗核验成功，请签字确认\"},{\"traceCode\":\"86123456789012131135\",\"vaccineName\":\"疫苗名称4\",\"vaccineSpecification\":\"疫苗规格4\",\"vaccineDosage\":\"疫苗剂型4)\",\"vaccineCreateDate\":\"2019-01-12\",\"vaccineValidDate\":\"2021-01-12\",\"vaccineBatchNum\":\"190112\",\"vaccineProduceEnterprise\":\"深圳疫苗企业有限公司\",\"vaccinateDosageTime\":\"1\",\"vaccinatePart\":\"左上臂\",\"vaccinateType\":\"常规\",\"checkstatus\":\"0\",\"checkerrormsg\":\"疫苗核验成功，请签字确认\"},{\"traceCode\":\"86123456789012131136\",\"vaccineName\":\"疫苗名称5\",\"vaccineSpecification\":\"疫苗规格5\",\"vaccineDosage\":\"疫苗剂型5\",\"vaccineCreateDate\":\"2019-01-13\",\"vaccineValidDate\":\"2021-01-13\",\"vaccineBatchNum\":\"190113\",\"vaccineProduceEnterprise\":\"深圳疫苗企业有限公司\",\"vaccinateDosageTime\":\"2\",\"vaccinatePart\":\"右上臂\",\"vaccinateType\":\"常规\",\"checkstatus\":\"0\",\"checkerrormsg\":\"\"}]},\"timestamp\":\"20190909103213214\"}';
		var datastr102='{\"ntype\":\"102\",\"orderId\":\"201901020506\",\"params\":{\"traceCode\":\"81892720186900107310\"},\"timestamp\":\"20190909103213214\"}';
		var datastr103='{\"ntype\":\"103\",\"orderId\":\"123456789\",\"timestamp\":\"20190131\"}';
		function Connect(){  
			try{  
				  socket=new WebSocket('ws://127.0.0.1:18500');  
			}catch(e){  
				return;  
			}  
			socket.onopen = sOpen;  
			socket.onerror = sError;
			socket.onmessage= sMessage;
			socket.onclose= sClose;
		
		}  
		function sOpen(){
			console.log('connect success!');
			if(datastr!=''){
				socket.send(datastr);
				datastr='';
			}
			isconnect=true;
		}
		function sError(e){
			console.log("error " + e);
			alert('请确认pc安心接种服务插件已启动');  
		}
		function sMessage(msg){  
			//alert('server says:' + msg.data); 
			showtext.value= msg.data;
		
		}
		function sClose(e){
			console.log("connect closed:" + e.code);
			isconnect=false;
			socket=null;
		}  
		function Send(){
			if(isconnect){
				socket.send(datastr101);
			}else{
			    datastr=datastr101;
				Connect();
			}
		} 
			function Send2(){
			if(isconnect){
				socket.send(datastr101Err);
			}else{
			    datastr=datastr101Err;
				Connect();
			}
		} 
		function Send3(){
			if(isconnect){
				socket.send(datastr101Mutil);
			}else{
			    datastr=datastr101Mutil;
				Connect();
			}
		} 
		function Send4(){
			if(isconnect){
				socket.send(datastr101Mutil5);
			}else{
			    datastr=datastr101Mutil5;
				Connect();
			}
		}
		function query(){
			if(isconnect){
				socket.send(datastr102);
			}else{
			    datastr=datastr102;
				Connect();
			}
		}
		function check(){
			if(isconnect){
				socket.send(datastr103);
			}else{
			    datastr=datastr103;
				Connect();
			}
		}
		function Close(){
			if(socket)
			{
			socket.close();
			isconnect=false;
			socket=null;
			}

		}  

	 </script>
	<h1><p><strong>数衍测试页</strong></p></h1>
</head>  
   
<body>   

<p>
<button id="send" onclick="Send();">推送显示屏信息(正常)</button>
<button id="send2" onclick="Send2();">推送显示屏信息(异常)</button>   
<button id="send3" onclick="Send3();">推送显示屏信息(正常多条)</button> 
<button id="send4" onclick="Send4();">推送显示屏信息(5条)</button> 
<button id="query" onclick="query();">查询电子监管码信息</button>   
<button id="close" onclick="Close();">关闭连接</button>
<button id="check" onclick="check();">检查电脑安心接种软件与设备连接状态</button> 
</p> </br>
<p>
<textarea name="showtext" id="showtext" style="width:1000px;height:400px;"  type="text"></textarea>
</p>
<p><h6>Copyright&nbsp;&copy;</h6>
</p>
</body>
</html>  