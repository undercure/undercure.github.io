<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>json生成器</title>
	 <script src="static/js/vue.js"></script>
	 <script src="/static/js/index.js"></script>
	 <link rel="stylesheet" href="static/css/index.css">
	 <link rel="stylesheet" href="static/css/BaseCSS.css">
	</head>
	<body>
		<div id ="app">
		<el-row>
			<el-col :span="8"><div class="grid-content bg-purple"><el-input v-model="ServerPort" placeholder="端口号"></el-input></div></el-col>
			<el-col :span="8"><div class="grid-content bg-purple-light"><el-input v-model="username" placeholder="用户名"></el-input></div>
			</el-col><el-col :span="8"><div class="grid-content bg-purple"><el-input v-model="password" placeholder="密码"></el-input></div></el-col>
		</el-row>
		<el-row >
			<div>
				<el-button type="primary" @click="confirmServerPort" plain>为IP地址添加端口号</el-button>
				<el-button type="primary" @click="confirmJson" plain>生成新json</el-button>
			</div>

		  </el-row>
		  <div id ="middle">
			<el-row>
				<el-col :span="12"><div id ="middleLeft" class="grid-content bg-purple">
					<el-input type="textarea":rows="20" id="IPAdrress" placeholder="此处粘贴IP地址" v-model="IPAdrress" ></el-input>
				</div>
				</el-col>
				<el-col :span="12"><div id ="middleLeft" class="grid-content bg-purple-light">
					<el-input type="textarea":rows="20" id="IPAdrressWithServerPort" placeholder="带有端口号的IP地址" v-model="IPAdrressWithServerPort" ></el-input></div>
				</el-col>
			</el-row>

			<el-row>
				<el-col :span="24"><div id ="middleLeft" class="grid-content bg-purple">
					<el-input type="textarea":rows="5" id="JsonResult" placeholder="此处生成json文件内容" v-model="JsonResult"></el-input></el-input>
				</div>
				</el-col>
			</el-row>
			</div>
		  
		</div>

		<script>
    		new Vue({
        		//链接id为app区域
        		el:"#app",
        		data(){
            		return {
                	//设定模型
					ServerPort:"",
                	username:"",
					password:"",
					IPAdrress:"",
					IPAdrressWithServerPort:"",
					JsonResult:""
           		 	}
        		},
				methods:{
					//给IP地址后面添加端口号
					confirmServerPort(){
						this.IPAdrressWithServerPort ="";
						const IPAdrr = this.IPAdrress.split('\n');
						for (let i = 0; i < IPAdrr.length; i++) {
							this.IPAdrressWithServerPort += IPAdrr[i] + "\:" + this.ServerPort;
							if( i !== IPAdrr.length -1){
								this.IPAdrressWithServerPort += "\n";
							}
						}
					},
					confirmJson(){
						const IPServer = this.IPAdrressWithServerPort.split('\n');
						//清空文本框内容
						this.JsonResult = "";
						//生成json文件字符串
						this.JsonResult += "{\n\t\"configs\" \: \[";
						for (let i = 0; i < IPServer.length; i++) {
							const temp = IPServer[i].split('\:');
							this.JsonResult += ( "\n\t\t\{"
														+ "\n\t\t\t\"AdditionalRoute\": \"\","
														+ "\n\t\t\t\"ConnectedTimes\": 0,"
														+ "\n\t\t\t\"Download_traffic\": 0,"
														+ "\n\t\t\t\"FailureTimes\": 0,"
														+ "\n\t\t\t\"Latency\": 0,"
														+ "\n\t\t\t\"Upload_traffic\": 0,"
														+ "\n\t\t\t\"charge_type\": 0,"
														+ "\n\t\t\t\"enable\": true,"
														+ "\n\t\t\t\"group\": \"myServer\","
														+ "\n\t\t\t\"iplocation\": \"\","
														+ "\n\t\t\t\"ipregion\": \"\","
														+ "\n\t\t\t\"method\": \"none\","
														+ "\n\t\t\t\"obfs\": \"plain\","
														+ "\n\t\t\t\"obfsparam\": \"\","
														+ "\n\t\t\t\"password\": \"" + this.password + "\","
														+ "\n\t\t\t\"protocol\": \"origin\","
														+ "\n\t\t\t\"protocolparam\": \"\","
														+ "\n\t\t\t\"remarks\": \"\","
														+ "\n\t\t\t\"server\"\:\"" + temp[0] + "\"\,"
														+ "\n\t\t\t\"server_port\"\:"+ temp[1] + "\,"
														+ "\n\t\t\t\"server_udp_port\": 0,"
														+ "\n\t\t\t\"type\": 5,"
														+ "\n\t\t\t\"udp_over_tcp\": 0,"
														+ "\n\t\t\t\"username\": \"" + this.username + "\"")
														+ "\n\t\t\}";
							if( i !== IPServer.length -1 ){
								this.JsonResult += ",";
							}
						}
						this.JsonResult += "\n\t\],\n\t\"idInUse\": 0\n\}";
					}
				}
    		})
		</script>
	</body>
</html>